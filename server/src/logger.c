/*------------------------------------------------------------------------------
  -- Copyright   : (C) 2016 CHRONOS project
  ------------------------------------------------------------------------------
  -- File        : logger.c
  -- Author      : Karl-Johan Ode
  -- Description : CHRONOS
  -- Purpose     :
  -- Reference   :
  ------------------------------------------------------------------------------*/

/*------------------------------------------------------------
  -- Include files.
  ------------------------------------------------------------*/
#include "logger.h"

#include <errno.h>
#include <mqueue.h>
#include <stdio.h>
#include <string.h>

#include "util.h"

/*------------------------------------------------------------
  -- Defines
  ------------------------------------------------------------*/

/*------------------------------------------------------------
  -- Function declarations.
  ------------------------------------------------------------*/

/*------------------------------------------------------------
-- Private variables
------------------------------------------------------------*/

/*------------------------------------------------------------
  -- Public functions
  ------------------------------------------------------------*/
void logger_task()
{
  (void)iCommInit(IPC_RECV,MQ_LG,0);

  /* Listen for commands */
  int iExit = 0;
  int iCommand;
  while(!iExit)
  {
    (void)iCommRecv(&iCommand,NULL,0);
	  if(iCommand == COMM_EXIT)
    {
      iExit = 1;  
    }
    else
    {
      #ifdef DEBUG
        printf("Unhandled command in logger\n");
      #endif
    }
  }

  (void)iCommClose();
}

/*------------------------------------------------------------
  -- Private functions
  ------------------------------------------------------------*/
